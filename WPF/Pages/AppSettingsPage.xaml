<Page x:Class="WPF.Pages.AppSettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Paramètres"
      Background="#1e1e2e">

    <Grid Margin="30,20,30,20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- En-tête de la page -->
        <TextBlock Grid.Row="0" 
                   Text="{DynamicResource GeneralSettings}"
                   FontSize="32" 
                   FontWeight="Bold" 
                   Margin="0,0,0,30"
                   Foreground="#cdd6f4"/>

        <!-- Contenu principal avec ScrollViewer pour s'adapter à de futures sections -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Section Langue -->
                <Border Background="#232336" 
                        CornerRadius="12"
                        Padding="20" 
                        Margin="0,0,0,20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Titre de la section -->
                        <TextBlock Grid.Row="0"
                                   Text="{DynamicResource LanguageSettings}"
                                   FontSize="22" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,10"
                                   Foreground="#cdd6f4"/>

                        <!-- Description de la section -->
                        <TextBlock Grid.Row="1" 
                                   Text="{DynamicResource ChooseLanguage}"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,15"
                                   Foreground="#a6adc8"/>

                        <!-- ComboBox pour la sélection de langue -->
                        <ComboBox Grid.Row="2"
                              x:Name="LanguageComboBox"
                              Padding="15,5"
                              Background="#313244"
                              Foreground="Black"
                              BorderThickness="0"
                              ItemsSource="{Binding LanguageOptions}"
                              SelectedValuePath="Key"
                              DisplayMemberPath="Value"
                              SelectedValue="{Binding SelectedLanguage}"
                              HorizontalAlignment="Left"
                              MinWidth="200">
                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Background" Value="#cdd6f4"/>
                                    <Setter Property="Foreground" Value="Black"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#45475a"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#74c7ec"/>
                                            <Setter Property="Foreground" Value="#232336"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>
                    </Grid>
                </Border>

                <!-- Section applications bloquantes -->
                <Border Background="#232336" 
                        CornerRadius="12"
                        Padding="20" 
                        Margin="0,0,0,20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Titre de la section -->
                        <TextBlock Grid.Row="0"
                                   Text="{DynamicResource BlockingApps}"
                                   FontSize="22" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,10"
                                   Foreground="#cdd6f4"/>

                        <!-- Description de la section -->
                        <TextBlock Grid.Row="1" 
                                   Text="{DynamicResource BlockingAppsDescription}"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,15"
                                   Foreground="#a6adc8"/>

                        <!-- Zone d'ajout d'application -->
                        <Grid Grid.Row="2" Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Champ texte -->
                            <TextBox x:Name="BlockingAppTextBox"
                                     Grid.Column="0"
                                     Height="40"
                                     Margin="0,0,10,0"
                                     Background="#313244"
                                     Foreground="#cdd6f4"
                                     BorderThickness="0"
                                     Padding="15,0"
                                     FontSize="16"
                                     VerticalContentAlignment="Center"
                                     BorderBrush="#74c7ec"/>

                            <!-- Bouton ajouter -->
                            <Button x:Name="AddBlockingAppButton"
                                    Grid.Column="1"
                                    Content="{DynamicResource AddApp}"
                                    Height="40"
                                    Width="100"
                                    Margin="0,0,10,0"
                                    Background="#74c7ec"
                                    Foreground="#232336"
                                    FontWeight="Bold"
                                    BorderThickness="0"
                                    Click="AddBlockingAppButton_Click"/>

                            <!-- Bouton détecter -->
                            <Button x:Name="DetectRunningAppButton"
                                    Grid.Column="2"
                                    Content="{DynamicResource DetectRunningApp}"
                                    Height="40"
                                    Width="100"
                                    Background="Transparent"
                                    Foreground="#74c7ec"
                                    FontWeight="Bold"
                                    BorderThickness="1"
                                    BorderBrush="#74c7ec"
                                    Click="DetectRunningAppButton_Click"/>
                        </Grid>

                        <!-- Liste des applications bloquantes -->
                        <Border Grid.Row="3"
                                Background="#313244" 
                                CornerRadius="8"
                                Margin="0,5,0,0">
                            <ListView x:Name="BlockingAppsListBox"
                                      ItemsSource="{Binding BlockingApplications}"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      Foreground="#cdd6f4"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                                      MaxHeight="300"
                                      MinHeight="150">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Height="40" Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                                <!-- Icône application -->
                                                <Viewbox Width="18" Height="18" Margin="0,0,10,0">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Fill="#74c7ec" Data="M21 2H3C1.9 2 1 2.9 1 4V20C1 21.1 1.9 22 3 22H21C22.1 22 23 21.1 23 20V4C23 2.9 22.1 2 21 2M21 7H3V4H21V7Z"/>
                                                    </Canvas>
                                                </Viewbox>
                                                <!-- Nom de l'application -->
                                                <TextBlock Text="{Binding}" 
                                                           FontSize="16" 
                                                           VerticalAlignment="Center" 
                                                           Foreground="#cdd6f4"/>
                                            </StackPanel>

                                            <!-- Bouton supprimer -->
                                            <Button Grid.Column="1" 
                                                    Width="30" 
                                                    Height="30"
                                                    Margin="10,0,0,0"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    ToolTip="{DynamicResource Delete}"
                                                    Tag="{Binding}"
                                                    Click="RemoveBlockingAppButton_Click">
                                                <Viewbox Width="16" Height="16">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Fill="#f38ba8" Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Button>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>

                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Padding" Value="10,5"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#45475a"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListView.ItemContainerStyle>
                            </ListView>
                        </Border>
                    </Grid>
                </Border>
                <Border Background="#232336" 
        CornerRadius="12"
        Padding="20" 
        Margin="0,0,0,20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Titre de la section -->
                        <TextBlock Grid.Row="0"
                   Text="{DynamicResource EncryptionSection}"
                   FontSize="22" 
                   FontWeight="SemiBold" 
                   Margin="0,0,0,10"
                   Foreground="#cdd6f4"/>

                        <!-- Section Extensions -->
                        <TextBlock Grid.Row="1" 
                   Text="{DynamicResource EncryptionExtensionsDescription}"
                   TextWrapping="Wrap"
                   Margin="0,0,0,15"
                   Foreground="#a6adc8"/>

                        <!-- Zone d'ajout d'extension -->
                        <Grid Grid.Row="2" Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Champ texte extension -->
                            <TextBox x:Name="ExtensionTextBox"
                     Grid.Column="0"
                     Height="40"
                     Margin="0,0,10,0"
                     Background="#313244"
                     Foreground="#cdd6f4"
                     BorderThickness="0"
                     Padding="15,0"
                     FontSize="16"
                     VerticalContentAlignment="Center"
                     BorderBrush="#74c7ec"/>

                            <!-- Bouton ajouter -->
                            <Button x:Name="AddExtensionButton"
                    Grid.Column="1"
                    Content="{DynamicResource AddExtension}"
                    Height="40"
                    Width="100"
                    Background="#74c7ec"
                    Foreground="#232336"
                    FontWeight="Bold"
                    BorderThickness="0"
                    Click="AddExtensionButton_Click"/>
                        </Grid>

                        <!-- Liste des extensions -->
                        <Border Grid.Row="3"
                Background="#313244" 
                CornerRadius="8"
                Margin="0,0,0,20">
                            <ListView x:Name="ExtensionsListBox"
                      ItemsSource="{Binding EncryptionFileExtensions}"
                      Background="Transparent"
                      BorderThickness="0"
                      Foreground="#cdd6f4"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      MaxHeight="200"
                      MinHeight="100">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Height="40" Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                                <!-- Icône fichier -->
                                                <Viewbox Width="18" Height="18" Margin="0,0,10,0">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Fill="#74c7ec" Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                                    </Canvas>
                                                </Viewbox>
                                                <!-- Extension -->
                                                <TextBlock Text="{Binding}" 
                                           FontSize="16" 
                                           VerticalAlignment="Center" 
                                           Foreground="#cdd6f4"/>
                                            </StackPanel>

                                            <!-- Bouton supprimer -->
                                            <Button Grid.Column="1" 
                                    Width="30" 
                                    Height="30"
                                    Margin="10,0,0,0"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    ToolTip="{DynamicResource Delete}"
                                    Tag="{Binding}"
                                    Click="RemoveExtensionButton_Click">
                                                <Viewbox Width="16" Height="16">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Fill="#f38ba8" Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Button>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>

                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Padding" Value="10,5"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#45475a"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListView.ItemContainerStyle>
                            </ListView>
                        </Border>

                        <!-- Section Wildcard -->
                        <TextBlock Grid.Row="4"
                   Text="{DynamicResource EncryptionWildcardDescription}"
                   TextWrapping="Wrap"
                   Margin="0,0,0,10"
                   Foreground="#a6adc8"/>

                        <!-- Champ texte wildcard -->
                        <TextBox x:Name="WildcardTextBox"
                 Grid.Row="5"
                 Height="40"
                 Margin="0"
                 Background="#313244"
                 Foreground="#cdd6f4"
                 BorderThickness="0"
                 Padding="15,0"
                 FontSize="16"
                 VerticalContentAlignment="Center"
                 BorderBrush="#74c7ec"
                 Text="{Binding EncryptionWildcard, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>

                </Border>
                <!-- Log Files Section -->
                <Border Background="#232336" 
        CornerRadius="12"
        Padding="20" 
        Margin="0,0,0,20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <!-- Header row -->
                            <RowDefinition Height="Auto"/>
                            <!-- Description row -->
                            <RowDefinition Height="Auto"/>
                            <!-- Daily log row (with formats options) -->
                            <RowDefinition Height="Auto"/>
                            <!-- State file row -->
                            <RowDefinition Height="Auto"/>
                            <!-- Warnings log row -->
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Section Title -->
                        <TextBlock Grid.Row="0"
                   Text="{DynamicResource LogFilesSection}"
                   FontSize="22" 
                   FontWeight="SemiBold" 
                   Margin="0,0,0,10"
                   Foreground="#cdd6f4"/>

                        <!-- Section Description -->
                        <TextBlock Grid.Row="1" 
                   Text="{DynamicResource LogFilesDescription}"
                   TextWrapping="Wrap"
                   Margin="0,0,0,15"
                   Foreground="#a6adc8"/>

                        <!-- Daily Log File (with formats options) -->
                        <Grid Grid.Row="2"
                              Margin="0,0,0,15"
                              >

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <!-- Icon -->
                                <ColumnDefinition Width="*"/>
                                <!-- Info text -->
                                <ColumnDefinition Width="Auto"/>
                                <!-- Open button -->
                                <ColumnDefinition Width="Auto"/>
                                <!-- Show in folder button -->
                            </Grid.ColumnDefinitions>

                            <!-- Icon -->
                            <Viewbox Width="24" Height="24" Margin="0,0,15,0">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="#74c7ec" Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M15,18H9V16H15V18M15,13H9V11H15V13M13,9V3.5L18.5,9H13Z"/>
                                </Canvas>
                            </Viewbox>

                            <!-- Information -->
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{DynamicResource DailyLogFile}" 
                           FontWeight="SemiBold"
                           FontSize="16"
                           Foreground="#cdd6f4"/>
                                <TextBlock Text="{Binding DailyLogFilePath}" 
                           TextWrapping="Wrap"
                           TextTrimming="CharacterEllipsis"
                           MaxWidth="600"
                           Foreground="#a6adc8"/>
                            </StackPanel>

                            <!-- Open File Button -->
                            <Button Grid.Column="2" 
                    x:Name="OpenDailyLogButton"
                    Content="{DynamicResource OpenFile}"
                    Margin="10,0,10,0"
                    Padding="10,5"
                    Background="#74c7ec"
                    Foreground="#232336"
                    BorderThickness="0"
                    Click="OpenDailyLogButton_Click"/>

                            <!-- Show in Folder Button -->
                            <Button Grid.Column="3" 
                    x:Name="ShowDailyLogFolderButton"
                    Content="{DynamicResource ShowInFolder}"
                    Padding="10,5"
                    Background="Transparent"
                    Foreground="#74c7ec"
                    BorderThickness="1"
                    BorderBrush="#74c7ec"
                    Click="ShowDailyLogFolderButton_Click"/>
                        </Grid>

                        <!-- JSON Log File -->
                        
                        

                        <!-- State File (state.json) -->
                        <Grid Grid.Row="3" Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <!-- Icon -->
                                <ColumnDefinition Width="*"/>
                                <!-- Info text -->
                                <ColumnDefinition Width="Auto"/>
                                <!-- Open button -->
                                <ColumnDefinition Width="Auto"/>
                                <!-- Show in folder button -->
                            </Grid.ColumnDefinitions>

                            <!-- Icon -->
                            <Viewbox Width="24" Height="24" Margin="0,0,15,0">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="#94e2d5" Data="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
                                </Canvas>
                            </Viewbox>

                            <!-- Information -->
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{DynamicResource StateFile}" 
                           FontWeight="SemiBold"
                           FontSize="16"
                           Foreground="#cdd6f4"/>
                                <TextBlock Text="{Binding StateFilePath}" 
                           TextWrapping="Wrap"
                           TextTrimming="CharacterEllipsis"
                           MaxWidth="600"
                           Foreground="#a6adc8"/>
                            </StackPanel>

                            <!-- Open File Button -->
                            <Button Grid.Column="2" 
                    x:Name="OpenStateFileButton"
                    Content="{DynamicResource OpenFile}"
                    Margin="10,0,10,0"
                    Padding="10,5"
                    Background="#94e2d5"
                    Foreground="#232336"
                    BorderThickness="0"
                    Click="OpenStateFileButton_Click"/>

                            <!-- Show in Folder Button -->
                            <Button Grid.Column="3" 
                    x:Name="ShowStateFileFolderButton"
                    Content="{DynamicResource ShowInFolder}"
                    Padding="10,5"
                    Background="Transparent"
                    Foreground="#94e2d5"
                    BorderThickness="1"
                    BorderBrush="#94e2d5"
                    Click="ShowStateFileFolderButton_Click"/>
                        </Grid>

                        <!-- Warnings Log File -->
                        <Grid Grid.Row="4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <!-- Icon -->
                                <ColumnDefinition Width="*"/>
                                <!-- Info text -->
                                <ColumnDefinition Width="Auto"/>
                                <!-- Open button -->
                                <ColumnDefinition Width="Auto"/>
                                <!-- Show in folder button -->
                            </Grid.ColumnDefinitions>

                            <!-- Icon -->
                            <Viewbox Width="24" Height="24" Margin="0,0,15,0">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="#fab387" Data="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z"/>
                                </Canvas>
                            </Viewbox>

                            <!-- Information -->
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{DynamicResource WarningsLogFile}" 
                           FontWeight="SemiBold"
                           FontSize="16"
                           Foreground="#cdd6f4"/>
                                <TextBlock Text="{Binding WarningsLogFilePath}" 
                           TextWrapping="Wrap"
                           TextTrimming="CharacterEllipsis"
                           MaxWidth="600"
                           Foreground="#a6adc8"/>
                            </StackPanel>

                            <!-- Open File Button -->
                            <Button Grid.Column="2" 
                    x:Name="OpenWarningsLogButton"
                    Content="{DynamicResource OpenFile}"
                    Margin="10,0,10,0"
                    Padding="10,5"
                    Background="#fab387"
                    Foreground="#232336"
                    BorderThickness="0"
                    Click="OpenWarningsLogButton_Click"/>

                            <!-- Show in Folder Button -->
                            <Button Grid.Column="3" 
                    x:Name="ShowWarningsLogFolderButton"
                    Content="{DynamicResource ShowInFolder}"
                    Padding="10,5"
                    Background="Transparent"
                    Foreground="#fab387"
                    BorderThickness="1"
                    BorderBrush="#fab387"
                    Click="ShowWarningsLogFolderButton_Click"/>
                        </Grid>
                    </Grid>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Boutons d'action -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Indicateur d'état -->
            <TextBlock Grid.Column="0" 
                       x:Name="StatusMessage"
                       Foreground="#a6e3a1" 
                       FontWeight="SemiBold"
                       VerticalAlignment="Center"
                       Visibility="Collapsed"/>

            <!-- Boutons -->
            <StackPanel Grid.Column="2" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Right">
                <Button x:Name="SaveSettingsButton"
                        Content="{DynamicResource Save}"
                        Height="40"
                        Width="150"
                        Margin="0,0,15,0"
                        Background="#74c7ec"
                        Foreground="#232336"
                        FontWeight="Bold"
                        BorderThickness="0"
                        FontSize="16"
                        Click="SaveSettingsButton_Click"/>

                <Button x:Name="CancelButton"
                        Content="{DynamicResource Cancel}"
                        Height="40"
                        Width="120"
                        Background="Transparent"
                        Foreground="#74c7ec"
                        FontWeight="Bold"
                        BorderThickness="1"
                        BorderBrush="#74c7ec"
                        FontSize="16"
                        Click="CancelButton_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
