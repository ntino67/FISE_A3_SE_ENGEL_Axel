<Window x:Class="WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="EasySave from ProSoft"
        Height="720" Width="1280"
        WindowStyle="None"
        AllowsTransparency="True" 
        Background="Transparent" 
        ResizeMode="NoResize">
    <Window.Resources>
        <!-- Couleur Sapphire -->
        <SolidColorBrush x:Key="SapphireBrush" Color="#74c7ec"/>
        <!-- Style global pour tous les boutons -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource SapphireBrush}"/>
            <Setter Property="Foreground" Value="#232336"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        <!-- Style pour ToggleButton Differential/Full -->
        <Style x:Key="DiffFullToggleStyle" TargetType="ToggleButton">
            <Setter Property="Width" Value="160"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid>
                            <Border x:Name="SwitchBorder"
                            CornerRadius="22"
                            Background="#45475a"
                            BorderBrush="#a6adc8"
                            BorderThickness="2"
                            Width="160" Height="44"/>
                            <Grid>
                                <TextBlock x:Name="DiffText"
                                   Text="Differential"
                                   FontWeight="Bold"
                                   FontSize="18"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Left"
                                   Margin="18,0,0,0"
                                   Foreground="#232336"
                                   Visibility="Visible"/>
                                <TextBlock x:Name="FullText"
                                   Text="Full"
                                   FontWeight="Bold"
                                   FontSize="18"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"
                                   Margin="0,0,18,0"
                                   Foreground="#232336"
                                   Visibility="Collapsed"/>
                            </Grid>
                            <Border x:Name="SwitchThumb"
                            Width="56" Height="36"
                            Background="#232336"
                            CornerRadius="18"
                            Margin="4"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            RenderTransformOrigin="0.5,0.5">
                                <Border.RenderTransform>
                                    <TranslateTransform X="0"/>
                                </Border.RenderTransform>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="SwitchBorder" Property="Background" Value="#a6e3a1"/>
                                <Setter TargetName="SwitchThumb" Property="Background" Value="#232336"/>
                                <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="DiffText" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="FullText" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False">
                                <Setter TargetName="SwitchBorder" Property="Background" Value="#45475a"/>
                                <Setter TargetName="SwitchThumb" Property="Background" Value="#232336"/>
                                <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Left"/>
                                <Setter TargetName="DiffText" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="FullText" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Style pour CheckBox (optionnel, inchangé) -->
        <Style TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid>
                            <Ellipse x:Name="Ellipse" Width="28" Height="28" Stroke="#a6adc8" StrokeThickness="2" Fill="#313244"/>
                            <Path x:Name="CheckMark" Data="M 7 15 L 13 21 L 21 9" Stroke="#a6e3a1" StrokeThickness="3" StrokeEndLineCap="Round" StrokeStartLineCap="Round" Visibility="Collapsed"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Ellipse" Property="Stroke" Value="#a6e3a1"/>
                                <Setter TargetName="Ellipse" Property="Fill" Value="#232336"/>
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </Window.Resources>
    <Border Background="#1e1e2e" CornerRadius="20">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="90"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <!-- BARRE SUPÉRIEURE PERSONNALISÉE -->
            <Border Grid.Row="0"
                    Background="Transparent"
                    CornerRadius="20,20,0,0"
                    MouseLeftButtonDown="TopBar_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="320"/>
                        <ColumnDefinition Width="437"/>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="180"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0"
                               Text="EasySave"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               Margin="30,0,0,0"
                               Foreground="#cdd6f4"
                               FontSize="44"
                               FontWeight="Bold" Height="58" Width="186"/>
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Height="70" Margin="0,0,12,0">
                        <Button Width="160" Height="70" Margin="10,0"
                                ToolTip="Paramètres"
                                Click="GlobalSettingsButton_Click">
                            <TextBlock Text="Paramètres" FontSize="28" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Button>
                        <Button Width="100" Height="70" Margin="10,0"
                                ToolTip="Logs"
                                Click="Bouton2_Click">
                            <TextBlock Text="Logs" FontSize="28" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Button>
                        <Button Width="90" Height="70" Margin="10,0"
                                ToolTip="Status"
                                Click="Bouton3_Click">
                            <TextBlock Text="Status" FontSize="28" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Button>
                    </StackPanel>
                    <Grid Grid.Column="2"/>
                    <StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center" Height="70" Width="180">
                        <Button Width="50" Height="70" Margin="5,0"
                                Background="Transparent" BorderThickness="0"
                                ToolTip="Réduire"
                                Click="MinimizeButton_Click">
                            <TextBlock Text="&#x2212;" FontSize="28" Foreground="#cdd6f4" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Button>
                        <Button Width="50" Height="70" Margin="5,0"
                                Background="Transparent" BorderThickness="0"
                                ToolTip="Agrandir/Restaurer"
                                Click="MaximizeButton_Click">
                            <TextBlock Text="&#x25A1;" FontSize="24" Foreground="#cdd6f4" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Button>
                        <Button Width="50" Height="70" Margin="5,0"
                                Background="Transparent" BorderThickness="0"
                                ToolTip="Fermer"
                                Click="CloseButton_Click">
                            <TextBlock Text="&#x2715;" FontSize="28" Foreground="#f38ba8" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
            <!-- CONTENU PRINCIPAL -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <!-- Colonne de gauche (Jobs + barre de recherche + boutons) -->
                <Grid Grid.Column="0" Background="#232336" Margin="0,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <!-- Barre de recherche + boutons alignés à droite, zone de texte à largeur fixe -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,10,10" HorizontalAlignment="Stretch">
                        <TextBox x:Name="SearchBox"
                                 Width="220"
                                 VerticalAlignment="Center"
                                 Height="36"
                                 Margin="10,0,5,0"
                                 Background="#313244"
                                 Foreground="#cdd6f4"
                                 FontSize="18"
                                 Padding="10,0"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="SearchJobButton"
                                    Width="36"
                                    Height="36"
                                    Margin="0,0,5,0"
                                    ToolTip="Rechercher"
                                    Click="SearchJobButton_Click">
                                <TextBlock Text="🔍" FontSize="20" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Button>
                            <Button x:Name="AddJobButton"
                                    Width="36"
                                    Height="36"
                                    Margin="0,0,0,0"
                                    ToolTip="Créer un job"
                                    Click="AddJobButton_Click">
                                <TextBlock Text="+" FontSize="24" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                    <!-- Liste des jobs avec espacement -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,0,0,0">
                        <ItemsControl x:Name="JobList" Margin="10,0,10,0">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#313244" CornerRadius="12" Margin="0,10,0,10" Padding="0" Height="110">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="3*"/>
                                                <ColumnDefinition Width="2*"/>
                                            </Grid.ColumnDefinitions>
                                            <!-- Checkbox (1/6) -->
                                            <CheckBox Grid.Column="0"
                                                      IsChecked="{Binding IsChecked}"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="Center"/>
                                            <!-- Nom du job (3/6) -->
                                            <TextBlock Grid.Column="1"
                                                       Text="{Binding Name}"
                                                       VerticalAlignment="Center"
                                                       HorizontalAlignment="Left"
                                                       FontSize="22"
                                                       Foreground="#cdd6f4"
                                                       FontWeight="Bold"
                                                       Margin="10,0,0,0"
                                                       TextTrimming="CharacterEllipsis"
                                                       TextWrapping="NoWrap"
                                                       Width="220"/>
                                            <!-- Paramètres + toggle (2/6) -->
                                            <Grid Grid.Column="2">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <!-- Bouton paramètres en haut à droite -->
                                                <Button Grid.Row="0"
                                                        Content="⚙"
                                                        Width="36" Height="36"
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Top"
                                                        Margin="0,5,5,0"
                                                        ToolTip="Paramètres du job"
                                                        Click="JobSettingsButton_Click" />
                                                <!-- Texte Full/Diff + toggle en bas à droite -->
                                                <StackPanel Grid.Row="1" Orientation="Vertical" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,5,5">
                                                    <ToggleButton IsChecked="{Binding IsActive}" Style="{StaticResource DiffFullToggleStyle}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    <!-- Bouton Run déroulant en bas + bouton Exécuter -->
                    <Grid Grid.Row="2" Margin="10,10,10,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox x:Name="RunComboBox" Height="50" FontSize="20" VerticalAlignment="Bottom" HorizontalAlignment="Stretch"
                                  Background="{StaticResource SapphireBrush}" Foreground="#232336" BorderThickness="0" SelectedIndex="0" Grid.Column="0">
                            <ComboBoxItem Content="Run current selected"/>
                            <ComboBoxItem Content="Run all"/>
                            <ComboBoxItem Content="Reset selection"/>
                        </ComboBox>
                        <Button x:Name="RunButton" Content="Exécuter" Height="50" Width="110" Margin="10,0,0,0"
                                VerticalAlignment="Bottom" Grid.Column="1"
                                Click="RunButton_Click"/>
                    </Grid>
                </Grid>
                <!-- Frame pour afficher les pages, occupe 3/4 de la largeur -->
                <Frame x:Name="MainFrame"
                       Grid.Column="1"
                       NavigationUIVisibility="Hidden"
                       Background="Transparent"/>
            </Grid>
        </Grid>
    </Border>
</Window>